knitr::opts_chunk$set(
comment = "",
results = "hold",
fig.show = "hold")
# set ggplot theme
theme_set(
theme_classic()
)
library("reshape") # variety of methods for reshaping data prior
library("janitor") # for cleaning variable names
library("DT") # for nice tables
library("Hmisc") # for smean function for bootstrapped confidence intervals
library("tidyverse") # for data wrangling, visualization, etc.
library("lme4") # for fitting and analyzing mixed models
library("MuMIn") # for calculating effect sizes
library("pwr") #for power analysis
library("simr") # for power analysis
library("ggpubr") # for publication Ready Plots
library("emmeans") # for post hoc tests
library("brms")        # for Bayesian regression modeling
library("tidybayes")   # for Bayesian regression modeling
# set ggplot theme
theme_set(
theme_classic()
)
###Pilot 2
#### Read in Data
df.responses = read.csv(file = "explanation_selection_negative_outcome-responses.csv", stringsAsFactors = F, sep = ",") %>%
select(-error)
df.participants <- read.csv(file = "explanation_selection_negative_outcome-participants.csv", stringsAsFactors = F, sep = ",") %>%
select(-c(proliferate.condition, error))
df.data2 <- merge(df.responses, df.participants, by="workerid")
df.exp2 <- df.data2 %>%
gather("index", "response", -c(workerid, proliferate.condition, age, ethnicity, gender, feedback, race))%>%
mutate(CausalStructure  =
case_when(
str_detect(proliferate.condition, "Conneg_") & str_detect(index, "response_1") ~ "Conjunctive",
str_detect(proliferate.condition, "Conneg_") & str_detect(index, "response_2") ~ "Disjunctive",
str_detect(proliferate.condition, "Disneg_") & str_detect(index, "response_1") ~ "Disjunctive",
str_detect(proliferate.condition, "Disneg_") & str_detect(index, "response_2") ~ "Conjunctive"))%>%
mutate(Order =
case_when(
str_detect(proliferate.condition, "Conneg_") ~ "conjunctive first",
str_detect(proliferate.condition, "Disneg_") ~ "disjunctive first"))%>%
mutate(ResponseType =
case_when(
str_detect(index, "explanation") ~ "explanation",
str_detect(index, "intervention")  ~ "intervention"))%>%
select(-index) %>%
spread(ResponseType, response) %>%
mutate(CausalStructure= factor(CausalStructure, levels=c("Conjunctive", "Disjunctive"))) %>%
mutate(explanation = recode (explanation,
"orange" = "abnormal",
"blue" = "normal" )) %>%
mutate(intervention = recode (intervention,
"orange" = "abnormal",
"blue" = "normal" )) %>%
mutate(abnormal_explanation =
case_when(
explanation == "abnormal" ~ "abnormal",
explanation != "abnormal"~ "other")) %>%
mutate(normal_explanation =
case_when(
explanation == "normal" ~ "normal",
explanation != "normal"~ "other")) %>%
mutate(nopreference_explanation =
case_when(
explanation == "no preference" ~ "no preference",
explanation != "no preference"~ "other")) %>%
mutate(abnormal_intervention =
case_when(
intervention== "abnormal" ~ "abnormal",
intervention!= "abnormal"~ "other")) %>%
mutate(normal_intervention  =
case_when(
intervention  == "normal" ~ "normal",
intervention  != "normal"~ "other")) %>%
mutate(nopreference_intervention  =
case_when(
intervention== "no preference" ~ "no preference",
intervention!= "no preference"~ "other"))
df.exp2subset<-df.exp2 %>%
filter(Order == "conjunctive first")
FigExplanations<- ggplot(df.exp2subset, aes(x=explanation, group = CausalStructure))+
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
coord_cartesian(ylim = c(0,1)) +
scale_y_continuous(labels=scales::percent_format(accuracy = 1), breaks = seq(0, 1, by=0.20)) +
ylab("proportion of  explanation responses") +
facet_wrap(~CausalStructure)+
theme_bw()+
theme(legend.position= "none")+
theme(
axis.text.x = element_text(angle = 20, hjust = 1, color="black", size = 14),
strip.text = element_text(color="black", size = 12))
FigExplanations
df.exp2subset<-df.exp2 %>%
filter(Order == "disjunctive first")
FigExplanations<- ggplot(df.exp2subset, aes(x=explanation, group = CausalStructure))+
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
coord_cartesian(ylim = c(0,1)) +
scale_y_continuous(labels=scales::percent_format(accuracy = 1), breaks = seq(0, 1, by=0.20)) +
ylab("proportion of  explanation responses") +
facet_wrap(~CausalStructure)+
theme_bw()+
theme(legend.position= "none")+
theme(
axis.text.x = element_text(angle = 20, hjust = 1, color="black", size = 14),
strip.text = element_text(color="black", size = 12))
FigExplanations
df.exp2subset<-df.exp2 %>%
filter(Order == "conjunctive first")
FigIntervention<-df.exp2subset %>%
ggplot(aes(x=intervention, group = CausalStructure))+
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
coord_cartesian(ylim = c(0,1)) +
scale_y_continuous(labels=scales::percent_format(accuracy = 1), breaks = seq(0, 1, by=0.20)) +
ylab("proportion of  intervention responses") +
facet_wrap(~CausalStructure)+
theme_bw()+
theme(legend.position= "none")+
theme(
axis.text.x = element_text(angle = 20, hjust = 1, color="black", size = 14),
strip.text = element_text(color="black", size = 12))
FigIntervention
df.exp2subset<-df.exp2 %>%
filter(Order == "disjunctive first")
FigIntervention<-df.exp2subset %>%
ggplot(aes(x=intervention, group = CausalStructure))+
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
coord_cartesian(ylim = c(0,1)) +
scale_y_continuous(labels=scales::percent_format(accuracy = 1), breaks = seq(0, 1, by=0.20)) +
ylab("proportion of  intervention responses") +
facet_wrap(~CausalStructure)+
theme_bw()+
theme(legend.position= "none")+
theme(
axis.text.x = element_text(angle = 20, hjust = 1, color="black", size = 14),
strip.text = element_text(color="black", size = 12))
FigIntervention
View(df.data2)
df.exp2b <- df.data2 %>%
gather("index", "response", -c(workerid, proliferate.condition, age, ethnicity, gender, feedback, race))%>%
mutate(explanation_conjunctive_1 = explanation_response_1)
View(df.data2)
df.exp2b <- df.data2 %>%
gather("index", "response", -c(workerid, proliferate.condition, age, ethnicity, gender, feedback, race))%>%
mutate(explanation_conjunctive_1 = explanation_response_1)
df.exp2b <- df.data2 %>%
gather("index", "response", -c(workerid, proliferate.condition, age, ethnicity, gender, feedback, race))
View(df.exp2b)
df.exp2 <- df.data2 %>%
gather("index", "response", -c(workerid, proliferate.condition, age, ethnicity, gender, feedback, race))%>%
mutate(CausalStructure  =
case_when(
str_detect(proliferate.condition, "Conneg_") & str_detect(index, "response_1") ~ "Conjunctive",
str_detect(proliferate.condition, "Conneg_") & str_detect(index, "response_2") ~ "Disjunctive",
str_detect(proliferate.condition, "Disneg_") & str_detect(index, "response_1") ~ "Disjunctive",
str_detect(proliferate.condition, "Disneg_") & str_detect(index, "response_2") ~ "Conjunctive"))%>%
mutate(Order =
case_when(
str_detect(proliferate.condition, "Conneg_") ~ "conjunctive first",
str_detect(proliferate.condition, "Disneg_") ~ "disjunctive first"))%>%
mutate(ResponseType =
case_when(
str_detect(index, "explanation") ~ "explanation",
str_detect(index, "intervention")  ~ "intervention"))
View(df.exp2)
df.exp2b <- df.data2 %>%
select(-c(workerid, proliferate.condition, age, ethnicity, gender, feedback, race))%>%
mutate(explanation_conjunctive_1 = explanation_response_1)
df.exp2b <- df.data2 %>%
select(-c(workerid, age, ethnicity, gender, feedback, race))%>%
mutate(explanation_conjunctive_1 = explanation_response_1)
df.exp2b <- df.data2 %>%
select(-c(workerid, age, ethnicity, gender, feedback, race))%>%
mutate(explanation_conjunctive_1 =
case_when(
str_detect(proliferate.condition, "Conneg_") ~explanation_response_1,
str_detect(proliferate.condition, "Conneg_") ~explanation_response_2))
df.exp2b <- df.data2 %>%
select(-c(workerid, age, ethnicity, gender, feedback, race))%>%
mutate(explanation_conjunctive_1 =
case_when(
str_detect(proliferate.condition, "Conneg_") ~explanation_response_1,
str_detect(proliferate.condition, "Disneg_") ~explanation_response_2))
df.exp2b <- df.data2 %>%
select(-c(workerid, age, ethnicity, gender, feedback, race))%>%
mutate(explanation_conjunctive =
case_when(
str_detect(proliferate.condition, "Conneg_") ~explanation_response_1,
str_detect(proliferate.condition, "Disneg_") ~explanation_response_2)) %>%
mutate(explanation_disjunctive =
case_when(
str_detect(proliferate.condition, "Conneg_") ~explanation_response_2,
str_detect(proliferate.condition, "Disneg_") ~explanation_response_1)) %>%
mutate(intervention_conjunctive =
case_when(
str_detect(proliferate.condition, "Conneg_") ~intervention_response_1,
str_detect(proliferate.condition, "Disneg_") ~ intervention_response_2)) %>%
mutate(intervention_disjunctive =
case_when(
str_detect(proliferate.condition, "Conneg_") ~ intervention_response_2,
str_detect(proliferate.condition, "Disneg_") ~ intervention_response_1))
df.summary<-df.exp2%>%
group_by(explanation_conjunctive, explanation_disjunctive, intervention_conjunctive, intervention_disjunctive) %>%
summarize(n = n())
df.summary<-df.exp2%>%
group_by(explanation_conjunctive, explanation_disjunctive, intervention_conjunctive, intervention_disjunctive)
df.summary<-df.exp2b%>%
group_by(explanation_conjunctive, explanation_disjunctive, intervention_conjunctive, intervention_disjunctive) %>%
summarize(n = n())
View(df.summary)
df.summary<-df.exp2b%>%
group_by(explanation_conjunctive, intervention_conjunctive, explanation_disjunctive, intervention_disjunctive) %>%
summarize(n = n())
df.summary<-df.exp2b%>%
group_by(explanation_conjunctive, intervention_conjunctive, explanation_disjunctive, intervention_disjunctive) %>%
summarize(n = n()) %>%
mutate(percentage =n/99)
